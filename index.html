<!DOCTYPE html>
<html>
<head>
  <title>Análise do Dólar</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <canvas id="myChart"></canvas>

  <script>
    const apiKey = 'DK5Y4FX25XHSRQ16';

    // Função para buscar a cotação atual
    async function buscarCotacaoAtual() {
      // ... (código já existente para buscar cotação atual)
    }

    // Função para buscar a série temporal diária
    async function buscarSerieTemporal() {
      const response = await fetch(`https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=USD/BRL&apikey=${apiKey}`);
      const data = await response.json();

      const dates = [];
      const prices = [];
      for (const date in data['Time Series Daily']) {
        dates.push(date);
        prices.push(data['Time Series Daily'][date]['4. close']);
      }

      return { dates, prices };
    }

    // Função para criar o gráfico
    function criarGrafico(labels, data) {
      const ctx = document.getElementById('myChart').getContext('2d');
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            label: 'Cotação do Dólar',
            data: data,
            borderColor: 'blue',
            fill: false
          }]
        },
        options: {
          scales: {
            x: {
              title: {
                display: true,
                text: 'Data'
              }
            },
            y: {
              title: {
                display: true,
                text: 'Cotação'
              }
            }
          }
        }
      });
    }

    // Função para calcular uma previsão simples (média móvel)
    function calcularPrevisao(prices) {
      const windowSize = 5; // Tamanho da janela para a média móvel
      const previsao = prices.slice(-windowSize).reduce((a, b) => a + b) / windowSize;
      return previsao;
    }

    // Chamada das funções
    async function main() {
      await buscarCotacaoAtual();
      const { dates, prices } = await buscarSerieTemporal();
      criarGrafico(dates, prices);
      const previsao = calcularPrevisao(prices);
      console.log('Previsão:', previsao);
    }

    main();
  </script>
</body>
</html>
